<!--************************************************************************
* Name               : CaseHour                                            *
* Description        : JusticeServer - Stopwatch widget for recording time *
* Created By         : Techbridge                                          *        
*************************************************************************-->
<apex:page standardController="Case" extensions="JS01.CaseHourController"  showHeader="false" sidebar="false">
   <html>
        <head>  
            <!-- STYLE SHEET -->  
            <apex:stylesheet value="{!URLFOR($Resource.JS01__SLDS, 'assets/styles/salesforce-lightning-design-system-vf.css')}"/>  
        </head>
        <body> 
            <!-- REQUIRED SLDS WRAPPER - CUSTOM SCOPING CLASS USED WHEN GENERATING CUSTOM CSS -->  
            <div class="LScope">
                <!-------------------------------------------- FORM ----------------------------------------------------->
                <div class="slds-panel slds-grid slds-grid--vertical slds-nowrap slds-form--compound" aria-labelledby="LeadIntakeForm">
                      <apex:form id="caseEditForm">
                       <!-- Loading Image -->
                       <apex:actionStatus id="status">
                            <apex:facet name="start">
                                <div style="height : 100%; position: fixed; top: 0; left: 0; right: 0; bottom: 0; opacity: 0.75; z-index: 1000; background-color: #ececec;">
                                    &nbsp;
                                </div>
                                <div style="height : 100%; position: fixed; left: 0; top: 0; bottom: 0; right: 0; z-index: 1001; margin: 50% 50%">
                                    <span style="color:#4a4a56;position: fixed;top: 50%;left: 50%;">
                                        <table><tr>
                                            <td><img src="/img/loading32.gif"/>&nbsp;&nbsp;</td>
                                            <td><b>Loading...</b></td>
                                            </tr></table>
                                    </span>
                                </div>  
                            </apex:facet> 
                        </apex:actionStatus>
                        <style>
                            .pbBody {
                                border: 0px;
                            }
                        </style>
                        <!-- Ending Load Image -->
                        <apex:pageMessages id="err"></apex:pageMessages>
                        <apex:actionFunction name="AFstopClock" action="{!stopClock}" status="status" rerender="buttonSection"/>
<!--------------------------------------------------------------------- HOURS ---------------------------------------------------------------->                        
                        <!-------------------------------------- START TIME ------------------------------->
                        <apex:outputPanel rendered="{!!displayHourBlock}" id="timeSection">
                          <div class="slds-panel__section">  
                               <div class="slds-form-element__row">  
                                    <div class="slds-form-element">  
                                      <apex:outputText value="{0,date,MM/dd/yy hh:mm a}" rendered="{!startFlag && NOT(saveFlag)}">Start Time :
                                          <apex:param value="{!startTime+offset}"/>
                                      </apex:outputText>
                                    </div>
                                </div>
                                <div class="slds-form-element__row" align="center"> 
                                    <div class="slds-form-element"> 
                                        <apex:outputText rendered="{!saveFlag}" value="Hours Saved!"/>
                                        <apex:outputLink value="/lightning/r/Hours__c/{!hourInserted.Id}/view" target="_blank" rendered="{!$User.UIThemeDisplayed == 'Theme4d' && saveFlag}"> 
                                            [{!hourInserted.Name}]
                                        </apex:outputLink>
                                        <apex:outputLink value="/{!hourInserted.Id}" target="_blank" rendered="{!$User.UIThemeDisplayed != 'Theme4d' && saveFlag}"> 
                                            [{!hourInserted.Name}]
                                        </apex:outputLink>
                                  </div>
                                </div>  
                            </div>  
                                <!--------------------------------------- BUTTONS ------------------------------->
                              <apex:outputPanel id="buttonSection">
                                    <div align="center" draggable="false" >           
                                      <apex:commandButton action="{!startClock}" value="Start Time" rendered="{!!startFlag}" styleClass="slds-button slds-button--brand" rerender="buttonSection,timeSection" status="status" id="startButton"/> 
                                      <apex:commandButton action="{!stopClock}" value="Stop Time" rendered="{!startFlag}" styleClass="slds-button slds-button--brand" status="status" id="stopButton" onclick="AFstopClock();"/> 
                                    </div>
                                </apex:outputPanel>
                            </apex:outputPanel>                   
                          <!--------------------------------- INPUT FIELDS ------------------------------->
                          <apex:outputPanel rendered="{!displayHourBlock}">
                               <div class="slds-panel__section">  
                                    <div class="form-element__group">  
                                        <div class="slds-form-element__row">  
                                            <div class="slds-form-element" > 
                                                <apex:outputLabel for="ipHourlyRate" value="What is your normal hourly rate for this task?" rendered="{!$Setup.JusticeServer_Settings__c.Show_Hourly_Rate__c}"/>
                                                <apex:inputText value="{!hourRec.JS01__Hourly_Rate__c}" id="ipHourlyRate" styleClass="slds-form-element__control slds-input" rendered="{!$Setup.JusticeServer_Settings__c.Show_Hourly_Rate__c}"/>
                                            </div>  
                                        </div>
                                        <div class="slds-form-element__row">  
                                            <div class="slds-form-element"> 
                                                <apex:outputLabel value="Comments"/>
                                                <apex:inputtextArea value="{!hourRec.JS01__Comments__c}" styleClass="slds-form-element__control slds-input slds-textarea"/>
                                            </div>
                                        </div>
                                        <div class="slds-form-element__row">  
                                            <div class="slds-form-element">     
                                                <apex:outputLabel value="Category"/>
                                                <apex:inputField value="{!hourRec.JS01__Category__c}" styleClass="slds-form-element__control slds-input"/>
                                            </div>
                                        </div>
                                        <div class="slds-form-element__row">  
                                            <div class="slds-form-element"> 
                                                <apex:outputLabel value="Sub Category"/>
                                                <apex:inputField value="{!hourRec.JS01__Sub_Category__c}" styleClass="slds-form-element__control slds-input"/>
                                            </div>
                                        </div>
                                    </div>
                                    <div align="center">
                                        <apex:commandButton value="Save" action="{!saveHour}" styleClass="slds-button slds-button--brand" status="status"/>
                                        <apex:actionSupport event="oncomplete" rerender="timeSection"/>
                                    </div>
                                </div>
                            </apex:outputPanel>
                    </apex:form>    
                    </div>
                </div>
            </body>  
        </html>     
</apex:page>